<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Vuecli2å¼•å…¥Arcgis-js-apiæ–¹æ¡ˆæ€»ç»“(éesri-loaderæ–¹å‘)"><meta name="keywords" content="webpack,vue,arcgis"><meta name="author" content="Rao Jinwei,undefined"><meta name="copyright" content="Rao Jinwei"><title>Vuecli2å¼•å…¥Arcgis-js-apiæ–¹æ¡ˆæ€»ç»“(éesri-loaderæ–¹å‘) | Rao Jinwei's Blog</title><link rel="shortcut icon" href="/sl.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.4.2"><script>var GLOBAL = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  localSearch: undefined
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å‰è¨€"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å·²å®ç°çš„åŠŸèƒ½"><span class="toc-number">2.</span> <span class="toc-text">å·²å®ç°çš„åŠŸèƒ½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ–¹æ¡ˆé€‰æ‹©"><span class="toc-number">3.</span> <span class="toc-text">æ–¹æ¡ˆé€‰æ‹©</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#esri-loader"><span class="toc-number">3.1.</span> <span class="toc-text">esri-loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ”¹-webpack-é…ç½®"><span class="toc-number">3.2.</span> <span class="toc-text">æ”¹ webpack é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vuex-çš„ä½œç”¨"><span class="toc-number">4.</span> <span class="toc-text">vuex çš„ä½œç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Eslint-å’Œ-Prettier"><span class="toc-number">5.</span> <span class="toc-text">Eslint å’Œ Prettier</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Githook"><span class="toc-number">6.</span> <span class="toc-text">Githook</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Arcgis-æ¡†æ¶-api-è¯­æ³•æç¤º"><span class="toc-number">7.</span> <span class="toc-text">Arcgis æ¡†æ¶ api è¯­æ³•æç¤º</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å†™åœ¨æœ€å"><span class="toc-number">8.</span> <span class="toc-text">å†™åœ¨æœ€å</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://avatars1.githubusercontent.com/u/23609695?s=400&amp;u=d2db8f6efdee5add420addf7f89b916f7ef47ca7&amp;v=4"></div><div class="author-info__name text-center">Rao Jinwei</div><div class="author-info__description text-center">è¿½å¯»ç”Ÿæ´»çš„å½±å­</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">13</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">15</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">åˆ†ç±»</span><span class="pull-right">9</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(http://pic1.win4000.com/wallpaper/7/59bb35a6c903f.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Rao Jinwei's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Vuecli2å¼•å…¥Arcgis-js-apiæ–¹æ¡ˆæ€»ç»“(éesri-loaderæ–¹å‘)</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-23</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/vue/">vue</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸‰ä¸ªæœˆå‰ï¼Œæˆ‘åœ¨å…¬å¸å†…éƒ¨è¿›è¡Œäº†ä¸€æ¬¡å…³äº<a href="https://github.com/shooterRao/Arcgis-webpack-PPT" target="_blank" rel="external">arcgis+webpck å®ç°å‰ç«¯å·¥ç¨‹åŒ–</a>çš„æŠ€æœ¯åˆ†äº«ã€‚åœ¨é‚£æ¬¡åˆ†äº«ä¸­ï¼Œæˆ‘åˆ†åˆ«ç®€å•ä¸¾ä¾‹äº†å…³äº<code>react+webpack+arcgis</code>ã€<code>vue+webpack+arcgis</code>ã€<code>ts+dojo+webpack+arcgis</code>è¿™å‡ ä¸ªæ–¹æ¡ˆçš„<a href="https://github.com/shooterRao/arcgis-webpack-demo" target="_blank" rel="external">å®ç°</a>ï¼Œå…¶ä¸­å¯¹<a href="https://github.com/shooterRao/arcgis-webpack-vue" target="_blank" rel="external">vue+webpack+arcgis</a>è¿™ä¸€æ–¹æ¡ˆè¿›è¡Œæ¯”è¾ƒå¤šçš„è®²è§£ï¼Œä½†é‚£æ—¶å€™çš„<code>vue-arcgis-demo</code>æ˜¯ç›´æ¥ç”¨<strong>webpack4.8.3</strong>ä»é›¶å¼€å§‹æ„å»ºçš„ï¼Œå¹¶æ²¡æœ‰åœ¨<code>vuecli2</code>ç”Ÿæˆçš„é¡¹ç›®åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œåœ¨é…ç½®æ–¹é¢è¿˜æ˜¯å­˜åœ¨è®¸å¤š<strong>ä¸è¶³</strong>ã€‚åæ¥æˆ‘ä»”ç»†ç ”ç©¶äº† vuecli2 ç”Ÿæˆé¡¹ç›®çš„ webpack é…ç½®ï¼Œææ˜ç™½ä¹‹åå°±ç›´æ¥æ”¹é…ç½®å¹¶æˆåŠŸæ¥å…¥ arcgis æ¡†æ¶äº†ï¼Œä¸‹é¢æ€»ç»“ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<a id="more"></a>
<h2 id="å·²å®ç°çš„åŠŸèƒ½"><a href="#å·²å®ç°çš„åŠŸèƒ½" class="headerlink" title="å·²å®ç°çš„åŠŸèƒ½"></a>å·²å®ç°çš„åŠŸèƒ½</h2><p>åœ¨ vuecli2 ç”Ÿæˆé¡¹ç›®çš„åŸºç¡€ä¸Šï¼Œç»è¿‡ä¿®æ”¹ webpack é…ç½®å’Œå¼•å…¥ä¸€äº›æ¨¡å—å®ç°äº†ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>ä¿®æ”¹ webpack é…ç½®æ”¯æŒä½¿ç”¨ arcgis æ¡†æ¶ï¼Œæ”¯æŒ<code>import Map from &#39;esri/Map&#39;</code>å†™æ³•</li>
<li>ä¿®æ”¹<code>html-webpack-plugin</code>é…ç½®ï¼Œæ”¯æŒåŠ¨æ€<code>require</code>æ³¨å…¥å¸¦<strong>Hash</strong>åç¼€çš„ js å’Œ css æ–‡ä»¶</li>
<li>å¢åŠ å¤–éƒ¨é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½ arcgis æ¡†æ¶æˆ–å…¶å®ƒå·¥å…·åº“</li>
<li>å¼•å…¥<code>@types/arcgis-js-api</code>ï¼Œ<code>@types/dojo</code>ï¼Œ<code>tsd.d.ts</code>ï¼Œæä¾› arcgis æ¡†æ¶åŠ dojo æ¡†æ¶ç›¸å…³ api è¯­æ³•æç¤º</li>
<li>å¼•å…¥ vuexï¼Œæ–¹ä¾¿åœ¨ Map ç»„ä»¶å®ä¾‹å·²æŒ‚è½½æƒ…å†µä¸‹ï¼Œå…¶å®ƒç»„ä»¶å¯ä»¥é€šè¿‡<code>this.map</code>æ–¹æ³•æ¥è·å–åœ°å›¾å®ä¾‹å¯¹è±¡</li>
<li>å¼•å…¥ eslint(airbnb)ã€prettier</li>
<li>å¼•å…¥ githook(pre-commit)ï¼Œgit</li>
</ul>
<h2 id="æ–¹æ¡ˆé€‰æ‹©"><a href="#æ–¹æ¡ˆé€‰æ‹©" class="headerlink" title="æ–¹æ¡ˆé€‰æ‹©"></a>æ–¹æ¡ˆé€‰æ‹©</h2><h3 id="esri-loader"><a href="#esri-loader" class="headerlink" title="esri-loader"></a>esri-loader</h3><p><code>esri-loader</code>æ˜¯åœ¨ esri å…¬å¸å·¥ä½œè€å¤–å†™çš„ä¸€ä¸ªåŠ è½½å™¨ã€‚æˆ‘çœ‹åˆ°åœ¨å…¬å¸ä¸€äº›å¼± gis çš„é¡¹ç›®ä¸­æœ‰ç”¨åˆ°ï¼Œä¹Ÿå°±æ˜¯ç”¨<code>esri-loader</code>æŠŠ arcgis é‡Œçš„ç›¸å…³æ¨¡å—ç»™åŠ è½½å‡ºæ¥ï¼Œä¸‹é¢æ˜¯å®˜æ–¹æ–‡æ¡£çš„ä¾‹å­ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">esriLoader</div><div class="line">  .loadModules([<span class="string">"esri/views/MapView"</span>, <span class="string">"esri/WebMap"</span>])</div><div class="line">  .then(<span class="function">(<span class="params">[MapView, WebMap]</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> webmap = <span class="keyword">new</span> WebMap(&#123;</div><div class="line">      portalItem: &#123;</div><div class="line">        id: <span class="string">"f2e9b762544945f390ca4ac3671cfa72"</span></div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">const</span> view = <span class="keyword">new</span> MapView(&#123;</div><div class="line">      map: webmap,</div><div class="line">      container: <span class="string">"viewDiv"</span></div><div class="line">    &#125;);</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.error(err);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>ä»ä»£ç ä¸Šçœ‹ï¼ŒesriLoader å®é™…ä¸Šè¿”å›çš„æ˜¯ä¸€ä¸ª<code>Promise</code>å®ä¾‹ï¼Œé‡Œé¢åŒ…è£…è¿™ç›¸å…³çš„æ¨¡å—ã€‚åæ¥æˆ‘çœ‹äº†ä¸‹è¿™ä¸ª esriLoader çš„æºç ï¼Œå®é™…ä¸Šå®ƒæ˜¯é€šè¿‡åŠ¨æ€åˆ›å»º<code>&lt;script&gt;</code>æ ‡ç­¾åŠ è½½ arcgis æ¡†æ¶ï¼Œç„¶åå†å»é€šè¿‡<code>require([&#39;mduleA&#39;, &#39;moduleB&#39;])</code>å»åŠ è½½ç›¸å…³æ¨¡å—ï¼Œæœ€å<code>Promise.resolve([])</code>å‡ºæ¥ã€‚</p>
<p>è¿™ç§æ–¹æ¡ˆè™½ç„¶æ˜¯å¯ä»¥è§£å†³åŠ è½½åœ°å›¾çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæŠŠè¿™ç§æ–¹æ¡ˆæ”¾åœ¨å¼º gis é¡¹ç›®ä¸Šï¼Œé‚£æ„å‘³ç€æ‰€æœ‰ arcgis ç›¸å…³æ¨¡å—éƒ½å¼ºä¾èµ–äº<code>esriLoader.loadModules</code>ï¼Œåœ°å›¾ç›¸å…³æ“ä½œçš„æ–¹æ³•éƒ½ä¸å¤ªå¥½è¿›è¡ŒæŠ½è±¡å’Œç®¡ç†ï¼Œå®Œå…¨è€¦åˆåœ¨æ¯ä¸ªç»„ä»¶é‡Œé¢äº†ï¼Œä¹Ÿä¸æ–¹ä¾¿è¿›è¡Œæ‹“å±•ã€‚è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œç”±äº<code>arcgis js api</code>çš„<code>init.js</code>å¾ˆå¤§ï¼Œå¦‚æœåœ¨ç½‘ç»œä¸å¥½çš„æƒ…å†µä¸‹ï¼Œåˆæ¬¡æŒ‚è½½åœ°å›¾ç»„ä»¶å¯èƒ½ä¼šå‡ºç°ç­‰å¾…æ—¶é—´æ¯”è¾ƒä¹…çš„é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¼± gis æ–¹é¢çš„é¡¹ç›®ï¼Œä¸éœ€è¦è¿›è¡Œå¤ªå¤šåœ°å›¾ç›¸å…³çš„æ“ä½œï¼Œä½¿ç”¨ esriloader æ˜¯ä¸€ç§ä¸é”™çš„æ–¹æ¡ˆï¼Œå› ä¸ºä½¿ç”¨å®ƒå®Œå…¨ä¸éœ€è¦ä¿®æ”¹ vuecli çš„ç›¸å…³é…ç½®ï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨ webpack é»˜è®¤çš„åŠ è½½å™¨ï¼Œä½¿ç”¨èµ·æ¥å‡ ä¹æ²¡ä»€ä¹ˆæˆæœ¬ã€‚</p>
<h3 id="æ”¹-webpack-é…ç½®"><a href="#æ”¹-webpack-é…ç½®" class="headerlink" title="æ”¹ webpack é…ç½®"></a>æ”¹ webpack é…ç½®</h3><p>å…¶å®ï¼Œåšè¿™ç§æ¥å…¥é€‚é…æœ€éš¾æçš„æ˜¯å¦‚ä½•è®© webpack æ¥å…¥ arcgis æ¡†æ¶ã€‚é¦–å…ˆ arcgis js api ä¾èµ– dojo1ï¼Œdojo1 ç”¨çš„æ˜¯<code>require.js</code>AMD æ¨¡å—åŠ è½½å™¨(dojo2 å·²ç»é‡æ„ï¼Œä¸å†ä¾èµ– require.jsï¼Œä½†æ˜¯æœ€æ–°çš„ arcgis ä»ç„¶ç”¨ dojo1)ï¼Œæ‰€ä»¥ arcgis æ¡†æ¶å†…éƒ¨ä¹Ÿæ˜¯åŸºäº AMD æ¨¡å—æ–¹å¼ç¼–å†™çš„ï¼Œwebpack ä¹Ÿæ˜¯æ¨¡å—æ‰“åŒ…å™¨ï¼Œåªä¸è¿‡æ¯”<code>require.js</code>å¼ºå¤§å¾—å¤šï¼Œæ€æƒ³æ›´åŠ å…ˆè¿›ï¼ŒåŠŸèƒ½ä¹Ÿæ›´åŠ ä¸°å¯Œã€‚webpack é»˜è®¤æ‰“åŒ…å‡ºæ¥çš„æ¨¡å—ä¸æ˜¯ AMD æ¨¡å—ï¼Œæ‰€ä»¥å¯¼è‡´æ‰“åŒ…å‡ºæ¥çš„æ¨¡å—å’Œ arcgis æ¡†æ¶çš„ AMD æ¨¡å—å¤©ç„¶ä¸å’Œï¼Œä¹Ÿå°±ä¸èƒ½ç›´æ¥åœ°ä½¿ç”¨<code>import Map from &#39;esri/Map</code>è¿™ç±»çš„å†™æ³•ã€‚è™½ç„¶ arcgis æ¨¡å—æ— æ³•è¢«æ‰“åŒ…æˆ webpack å¯ä»¥è®¤è¯†çš„æ¨¡å—ï¼Œä½†æ˜¯åè¿‡æ¥ï¼Œå¼ºå¤§çš„ webpack å¯ä»¥æŠŠæ¨¡å—æ‰“åŒ…æˆ AMD æ¨¡å—ï¼Œè®© arcgis æ¡†æ¶è¯†åˆ«å¹¶åŠ è½½å‡ºæ¥ï¼Œæ‰€ä»¥é—®é¢˜å°±è§£å†³äº†ã€‚</p>
<p>ä¸‹é¢ï¼Œæ˜¯æ¯ä¸ªæ­¥éª¤çš„è¯¦ç»†ä»‹ç»ï¼š</p>
<ul>
<li>é¦–å…ˆï¼Œç¬¬ä¸€æ­¥ï¼Œå¦‚ä¸Šæ–‡è¯´çš„ï¼Œè®© webpack å¸®æˆ‘ä»¬æ‰“åŒ…æ¨¡å—ä¸º AMD æ¨¡å—ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨<code>vue/build/webpack.base.conf.js</code>æ–‡ä»¶ä¸­ï¼Œwebpack çš„ output é…ç½®ä¸­åŠ å¤šä¸€è¡Œä»£ç ï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  output: &#123;</div><div class="line">    libraryTarget: <span class="string">"amd"</span> <span class="comment">// è§£å†³amdæ¨¡å—é—®é¢˜</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ul>
<li>æ—¢ç„¶è®© webpack æŠŠæ‰€æœ‰æ¨¡å—éƒ½æ‰“åŒ…æˆ AMD æ¨¡å—äº†ï¼Œé‚£ä¹ˆ webpack åœ¨å¤„ç†<code>import Map from &#39;esri/Map&#39;</code>è¿™å—ä»£ç æ—¶ï¼Œä»ç„¶ä¼šæŠ¥é”™ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºé¡¹ç›®å’Œ<code>node_modules</code>ä¸­æ²¡æœ‰<code>esri</code>è¿™ä¸ªæ¨¡å—ï¼Œ<code>esri</code>çš„æ¨¡å—æ˜¯é€šè¿‡<code>require.js</code>è¿›è¡ŒåŠ è½½çš„ã€‚æ‰€ä»¥è§£å†³æ–¹æ³•æ˜¯æ·»åŠ  webpack é…ç½®ï¼Œè®© webpack åœ¨å¤„ç†ç±»ä¼¼<code>import Map from &#39;esri/Map&#39;</code>è¿™ç§<code>esri</code>ã€<code>dojo</code>å¼€å¤´çš„æ¨¡å—ï¼Œä¸ä½œå¤„ç†ï¼Œç›´æ¥æ”¾å›<code>Map</code>ï¼Œç»Ÿä¸€ç”¨<code>require.js</code>è¿›è¡ŒåŠ è½½ã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š</li>
</ul>
<p>ä¾æ—§åœ¨<code>vue/build/webpack.base.conf.js</code>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="comment">// æœ«å°¾æ·»åŠ å³å¯ (å…¶å®é¡ºåºä¸é‡è¦)</span></div><div class="line">  externals: [</div><div class="line">    <span class="comment">// å½“é‡åˆ°å¼•å…¥åŒ…å«dojo/esri/dgpç­‰æ¨¡å—æ—¶ï¼Œä¸å¤„ç†</span></div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">context, request, callback</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (</div><div class="line">        /^dojo/.test(request) ||</div><div class="line">        /^dojox/.test(request) ||</div><div class="line">        /^dijit/.test(request) ||</div><div class="line">        /^esri/.test(request)</div><div class="line">      ) &#123;</div><div class="line">        <span class="keyword">return</span> callback(<span class="literal">null</span>, <span class="string">"amd "</span> + request);</div><div class="line">      &#125;</div><div class="line">      callback();</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ul>
<li><p>å‰©ä¸‹è¦è§£å†³çš„æ˜¯<code>html-webpack-plugin</code>æ’ä»¶åŠ¨æ€æ³¨å…¥èµ„æºçš„é—®é¢˜äº†ã€‚åœ¨å¼€å‘ç¯å¢ƒå’Œç”Ÿæˆç¯å¢ƒä¸­ï¼Œvuecli2 æ˜¯é»˜è®¤å¼€å¯è®©<code>html-webpack-plugin</code>æ’ä»¶åŠ¨æ€æ³¨å…¥èµ„æºåˆ°<code>index.html</code>æ¨¡å—ä¸Šçš„ï¼Œæ‰€è°“çš„èµ„æºï¼Œä¸»è¦å°±æ˜¯ webpack æ„å»ºå®Œæˆåçš„ js å’Œ cssã€‚é»˜è®¤çš„æ³¨å…¥æ–¹å¼æ˜¯æ„å»º<code>script</code>æ ‡ç­¾è¿›è¡Œ src å¼•å…¥ã€‚å› ä¸º webpack æ‰“åŒ…åçš„æ¨¡å—éƒ½æ˜¯<code>define(xxx, function())</code>è¿™ç§å½¢å¼çš„ AMD æ¨¡å—ï¼Œé€šè¿‡<code>script</code>æ ‡ç­¾å¼•å…¥æµè§ˆå™¨æ˜¯è¯†åˆ«ä¸äº†çš„ï¼Œæ‰€ä»¥å¿…é¡»å¾—ç”¨<code>require(xxx)</code>æ–¹æ³•è¿›è¡ŒåŠ è½½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨<code>vue/build/webpack.dev.conf.js</code>å’Œ<code>vue/build/webpack.prod.conf.js</code>æ–‡ä»¶ä¸­æ‰¾åˆ°<code>html-webpack-plugin</code>æ’ä»¶çš„ç›¸å…³é…ç½®ï¼Œå‘ç°å®ƒçš„é»˜è®¤é…ç½®é¡¹ä¸å¤šï¼Œ<code>dev</code>å’Œ<code>prod</code>çš„é…ç½®åŒºåˆ«ä¹Ÿå°±æ˜¯è·¯å¾„å’Œæ˜¯å¦å‹ç¼©ï¼Œå¯å‚è€ƒçš„é€‰é¡¹å¹¶ä¸å¤šã€‚æ‰€ä»¥æˆ‘åªå¥½å»<code>html-webpack-plugin</code>æ’ä»¶çš„<a href="https://github.com/ampedandwired/html-webpack-plugin" target="_blank" rel="external">github æ–‡æ¡£</a>ä¸ŠæŸ¥è¯¢æ˜¯å¦æœ‰æˆ‘æƒ³è¦çš„ apiï¼Œæ›´æ”¹åŠ¨æ€è¾“å‡º js çš„æ–¹æ³•ã€‚ç»è¿‡ä¸€ç•ªæŸ¥é˜…ï¼Œå‘ç°åªèƒ½é€šè¿‡å¼•å…¥è‡ªå®šä¹‰çš„ html æ¨¡æ¿ï¼Œå†æ·»åŠ <code>loadsh</code>æ¨¡æ¿è¯­æ³•è¿›è¡ŒåŠ¨æ€æ³¨å…¥èµ„æºã€‚</p>
<p>1.é¦–å…ˆï¼Œç»Ÿä¸€åœ¨<code>html-webpack-plugin</code>çš„é…ç½®å¯¹è±¡ä¸­æ·»åŠ <code>inject: false</code></p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> HtmlWebpackPlugin(&#123;</div><div class="line">  filename: <span class="string">"index.html"</span>,</div><div class="line">  template: <span class="string">"index.html"</span>,</div><div class="line">  inject: <span class="literal">false</span> <span class="comment">// ä¸è¿›è¡Œè‡ªåŠ¨æ³¨å…¥ï¼Œæ”¹ä¸ºæ¨¡æ¿æ³¨å…¥</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>2.åœ¨æ ¹ç›®å½•ä¸‹çš„<code>index.html</code>ä¸‹è¿›è¡Œæ·»åŠ æ¨¡æ¿è¯­æ³•ï¼Œåˆ†åˆ«å¤„ç†æ‰“åŒ…å¥½çš„ css å’Œ js</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">...</div><div class="line"><span class="comment">&lt;!-- åŠ¨æ€æ³¨å…¥app.hash.cssç­‰ --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span>(<span class="attr">const</span> <span class="attr">cssChunk</span> <span class="attr">of</span> <span class="attr">htmlWebpackPlugin.files.css</span>) &#123;%&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"&lt;%= cssChunk %&gt;"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>/&gt;</span>&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript">  <span class="keyword">var</span> chunks = [];</span></div><div class="line"><span class="javascript">  <span class="string">`&lt;% for (const jsChunk of htmlWebpackPlugin.files.js) &#123; %&gt;`</span></span></div><div class="line"><span class="javascript">    chunks.push(<span class="string">"&lt;%= jsChunk %&gt;"</span>);</span></div><div class="line"><span class="javascript">  <span class="string">`&lt;% &#125; %&gt;`</span></span></div><div class="line"><span class="javascript">  <span class="comment">// é€šè¿‡requireåŠ è½½æ‰“åŒ…å¥½çš„æ¨¡å—(manifest.hash.js,ã€vendor.hash.jsã€app.hash.js...)</span></span></div><div class="line"><span class="javascript">  <span class="built_in">require</span>(chunks)</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿™äº› chunk éƒ½æ˜¯å¸¦æœ‰ Hash å€¼çš„ï¼Œé«˜æ•ˆåˆ©ç”¨æµè§ˆå™¨ç¼“å­˜æœºåˆ¶</strong></p>
<p>3.å®Œæˆä»¥ä¸Šæ­¥éª¤ä¹‹åï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œåœ¨åŠ è½½ä¸šåŠ¡æ¨¡å—ä¹‹å‰ï¼Œå¿…é¡»å…ˆåŠ è½½ arcgis æ¡†æ¶ã€‚æ–¹æ³•æœ‰ 2 ç§ï¼Œä¸€æ˜¯ç›´æ¥åœ¨<code>index.html</code>æ¨¡æ¿é‡Œé¢æ·»åŠ ï¼ŒäºŒæ˜¯ç»§ç»­åˆ©ç”¨<code>html-webpack-plugin</code>æŠŠæ¡†æ¶å¼•å…¥è¿›æ¥ã€‚æˆ‘ä¸ªäººè®¤ä¸ºç¬¬äºŒç§æ–¹å¼æ›´ä¸ºä¼˜é›…ï¼Œä¹Ÿæ–¹ä¾¿å¼€å‘çš„å°ä¼™ä¼´åœ¨ä¸åŒä¸ªäººç¯å¢ƒä¸­ä¿®æ”¹é…ç½®é¡¹ï¼Œæ‰€ä»¥ç”¨äº†ç¬¬äºŒç§æ–¹æ³•ï¼š</p>
<p>å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º<code>appConfig.js</code>ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  htmlOpts: &#123;</div><div class="line">    title: <span class="string">"vuecli2-arcgis-base"</span>,</div><div class="line">    libs: &#123;</div><div class="line">      arcgisJsApi: &#123;</div><div class="line">        js: <span class="string">"http://localhost:8080/arcgis4.7/init.js"</span>,</div><div class="line">        css: <span class="string">"http://localhost:8080/arcgis4.7/esri/css/main.css"</span></div><div class="line">      &#125;</div><div class="line">      <span class="comment">// è¿™é‡Œå¯ä»¥ç»§ç»­æ·»åŠ å„ç§åº“jqï¼Œlodash...</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å†åœ¨<code>index.html</code>æ¨¡æ¿ä¸­è¿›è¡Œå¼•å…¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- åŠ¨æ€æ³¨å…¥è‡ªå®šä¹‰css --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span>(<span class="attr">const</span> <span class="attr">i</span> <span class="attr">of</span> <span class="attr">Object.keys</span>(<span class="attr">htmlWebpackPlugin.options.libs</span>)) &#123;%&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">const</span> <span class="attr">lib</span> = <span class="string">htmlWebpackPlugin.options.libs[i]%</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span>(!!<span class="attr">lib.css</span>) &#123; %&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">'stylesheet'</span> <span class="attr">href</span>=<span class="string">'&lt;%= lib.css %&gt;'</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- æœ€å¼€å¤´å¼•å…¥lib --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">for</span>(<span class="attr">const</span> <span class="attr">i</span> <span class="attr">of</span> <span class="attr">Object.keys</span>(<span class="attr">htmlWebpackPlugin.options.libs</span>)) &#123;%&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">const</span> <span class="attr">lib</span> = <span class="string">htmlWebpackPlugin.options.libs[i]%</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span>(!!<span class="attr">lib.js</span>) &#123; %&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&lt;%= lib.js %&gt;"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·å·®ä¸å¤šå°±å®Œæˆäº†ï¼Œä¸è¿‡ï¼Œæˆ‘è§‰å¾—å¯ä»¥å°è£…ä¸‹ç›¸å…³é…ç½®ï¼Œåœ¨<code>vue/build/webpack.dev.conf.js</code>é‡Œé¢åŠ å…¥ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// é…ç½®é…ç½®æ–‡ä»¶åˆå¹¶HtmlWebpackPluginé€‰é¡¹</span></div><div class="line"><span class="keyword">const</span> htmlOpts = <span class="built_in">require</span>(<span class="string">"../appConfig.js"</span>).htmlOpts;</div><div class="line"><span class="comment">// é»˜è®¤é…ç½®</span></div><div class="line"><span class="keyword">const</span> htmlDevOpts = &#123;</div><div class="line">  filename: <span class="string">"index.html"</span>,</div><div class="line">  template: <span class="string">"index.html"</span>,</div><div class="line">  inject: <span class="literal">false</span>,</div><div class="line">  chunks: <span class="string">"all"</span></div><div class="line">&#125;;</div><div class="line"><span class="comment">// åˆå¹¶é…ç½®</span></div><div class="line"><span class="keyword">const</span> HtmlWebpackPluginOpts = <span class="built_in">Object</span>.assign(&#123;&#125;, htmlDevOpts, htmlOpts);</div><div class="line"><span class="comment">// åœ¨pluginä¸­æ”¹ä¸º</span></div><div class="line"><span class="keyword">new</span> HtmlWebpackPlugin(HtmlWebpackPluginOpts);</div></pre></td></tr></table></figure>
<p>åœ¨<code>vue/build/webpack.prod.conf.js</code>é‡Œé¢ï¼ŒåŠ å…¥å·®ä¸å¤šçš„é…ç½®</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// é…ç½®é…ç½®æ–‡ä»¶åˆå¹¶HtmlWebpackPluginé€‰é¡¹</span></div><div class="line"><span class="keyword">const</span> htmlOpts = <span class="built_in">require</span>(<span class="string">"../appConfig.js"</span>).htmlOpts;</div><div class="line"><span class="comment">// é»˜è®¤é…ç½®</span></div><div class="line"><span class="keyword">const</span> htmlDefaultProdOpts = &#123;</div><div class="line">  filename: config.build.index,</div><div class="line">  template: <span class="string">"index.prod.html"</span>,</div><div class="line">  inject: <span class="literal">false</span>,</div><div class="line">  minify: &#123;</div><div class="line">    removeComments: <span class="literal">true</span>,</div><div class="line">    collapseWhitespace: <span class="literal">true</span>,</div><div class="line">    removeAttributeQuotes: <span class="literal">true</span></div><div class="line">  &#125;,</div><div class="line">  chunksSortMode: <span class="string">"dependency"</span>,</div><div class="line">  chunks: <span class="string">"all"</span></div><div class="line">&#125;;</div><div class="line"><span class="comment">// åˆå¹¶é…ç½®</span></div><div class="line"><span class="keyword">const</span> HtmlWebpackPluginOpts = <span class="built_in">Object</span>.assign(&#123;&#125;, htmlDefaultProdOpts, htmlOpts);</div><div class="line"></div><div class="line"><span class="keyword">new</span> HtmlWebpackPlugin(HtmlWebpackPluginOpts);</div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼šåœ¨æ ¹ç›®å½•ä¸­æ·»åŠ  index.prod.html æ–‡ä»¶ï¼ŒåŒºåˆ«äºå¼€å‘ç¯å¢ƒ</strong></p>
<p>æœ€åï¼Œå¯ä»¥åˆ†åˆ«å°è¯•ç”¨<code>yarn dev</code>ï¼Œ<code>yarn build</code>è¿›è¡Œæµ‹è¯•ä¸‹ï¼Œå¦‚æœæ­¥éª¤ âœ… çš„è¯ï¼Œé¡¹ç›®æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ã€‚</p>
<h2 id="vuex-çš„ä½œç”¨"><a href="#vuex-çš„ä½œç”¨" class="headerlink" title="vuex çš„ä½œç”¨"></a>vuex çš„ä½œç”¨</h2><p>åœ¨ä¸€äº›å¼± gis é¡¹ç›®ä¸­ï¼Œæˆ‘çœ‹åˆ°å¤§éƒ¨åˆ†æ˜¯é‡‡ç”¨<code>EventBus</code>è¿™ç§æ–¹å¼è¿›è¡Œè·¨ç»„ä»¶çš„äº‹ä»¶ä¼ æ’­ã€‚äº‹ä»¶å°‘çš„æƒ…å†µå€’æ²¡ä»€ä¹ˆï¼Œåªè¦æ³¨æ„<strong>å¤šæ¬¡æŒ‚è½½çš„ç»„ä»¶å¿…é¡»åœ¨ destroy å£°æ˜å‘¨æœŸä¸­è§£é™¤ç»‘å®šçš„äº‹ä»¶</strong>å³å¯ã€‚ä½†æ˜¯å¯¹äºå¼º gis é¡¹ç›®ï¼Œåœ°å›¾<code>Map</code>å®ä¾‹å¯¹è±¡æ˜¯å¾ˆå¤šç»„ä»¶ä¼šé¢‘ç¹ç”¨åˆ°çš„ï¼Œå¦‚æœå¤§é‡ä½¿ç”¨<code>EventBus</code>è¿›è¡Œ<code>Map</code>å¯¹è±¡ä¼ é€’å’Œäº‹ä»¶åˆ†å‘ï¼Œè¿™æ ·ç»´æŠ¤èµ·æ¥éå¸¸å›°éš¾ã€‚æ‰€ä»¥ï¼Œå¼•å…¥<code>vuex</code>è¿›è¡Œ<code>Map</code>å¯¹è±¡ç¼“å­˜å’Œå…¨å±€çŠ¶æ€ç®¡ç†æ˜¯ç§ä¸é”™çš„æ–¹æ³•ï¼Œ<code>vuex</code>å…¶å®ç›¸å½“äºç»„ä»¶å¯å…±äº«çš„å…¨å±€å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šç›´æ¥æš´éœ²åœ¨<code>window</code>å…¨å±€å˜é‡ä¸Šã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç®€å•å†™ä¸ª map çš„ storeï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> map = &#123;</div><div class="line">  state: &#123;</div><div class="line">    map: <span class="literal">null</span>,</div><div class="line">    mapView: <span class="literal">null</span></div><div class="line">  &#125;,</div><div class="line">  actions: &#123;</div><div class="line">    setMap(&#123; commit &#125;, value) &#123;</div><div class="line">      commit(<span class="string">"SET_MAP"</span>, value);</div><div class="line">    &#125;,</div><div class="line">    setMapView(&#123; commit &#125;, value) &#123;</div><div class="line">      commit(<span class="string">"SET_MAPVIEW"</span>, value);</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  mutations: &#123;</div><div class="line">    SET_MAP(state, value) &#123;</div><div class="line">      state.map = value;</div><div class="line">    &#125;,</div><div class="line">    SET_MAPVIEW(state, value) &#123;</div><div class="line">      state.mapView = value;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>map çš„ store æœ€å¥½é€šè¿‡ä»¥ module çš„å½¢å¼è¿›è¡Œæ³¨å†Œ</strong></p>
<p>åœ¨ Map ç»„ä»¶å®ä¾‹åŒ–åï¼Œ<code>map</code>å’Œ<code>mapView</code>å¯¹è±¡ä¼šç¼“å­˜åœ¨ vuex ä¸­ï¼Œåœ¨æ‰€æœ‰ç»„ä»¶ä¸­éƒ½å¯ä»¥é€šè¿‡<code>const { map, mapView } = this.$store.state.map</code>è¿™ç§æ–¹å¼è¿›è¡Œå–åˆ°å¯¹åº”çš„å€¼</p>
<p>ä½†æ˜¯è¿™ç§æ–¹æ³•è¿˜ä¸ç®—æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>vuex</code>æä¾›çš„<code>getter</code>æ–¹æ³•è¿›è¡Œå–<code>map</code>å’Œ<code>mapView</code>å¯¹è±¡ï¼Œåˆ›å»º<code>getters.js</code>ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  map: <span class="function"><span class="params">state</span> =&gt;</span> state.map.map,</div><div class="line">  mapView: <span class="function"><span class="params">state</span> =&gt;</span> state.map.mapView</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨<code>new Vuex.Store({ getters })</code>æ³¨å†Œ getters</p>
<p>æ¥ç€ï¼Œåœ¨å…¶å®ƒç»„ä»¶ä¸­ï¼ŒåŠ å…¥ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">"vuex"</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  computed: &#123;</div><div class="line">    ...mapGetters([<span class="string">"map"</span>, <span class="string">"mapView"</span>]) <span class="comment">// åœ¨å‡½æ•°ä¸­é€šè¿‡this.mapã€this.mapVieå°±å¯ä»¥è·å–ç›¸å…³å¯¹è±¡äº†</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>mapGetters è¿™ç±»å¯¹è±¡å¯ä»¥ç»Ÿä¸€ç”¨<code>Mixins: []</code>æ–¹å¼è¿›è¡ŒæŒ‚è½½</strong></p>
<h2 id="Eslint-å’Œ-Prettier"><a href="#Eslint-å’Œ-Prettier" class="headerlink" title="Eslint å’Œ Prettier"></a>Eslint å’Œ Prettier</h2><p>åœ¨æˆ‘æ¥æ‰‹ç»´æŠ¤å¹¿å·é¡¹ç›®çš„æ—¶å€™ï¼Œå‘ç°é‡Œé¢çš„é¡¹ç›®ä»£ç æ˜¯æ²¡æœ‰è§„èŒƒçš„ï¼Œä»£ç é£æ ¼è¿¥å¼‚ï¼Œæ³¨é‡Šè¾ƒå°‘ï¼Œæ‰€ä»¥åœ¨åŠ éœ€æ±‚å’Œæ”¹ bug çš„æ—¶å€™å°±éå¸¸ç—›è‹¦äº†ï¼Œæœ€æ‹…å¿ƒçš„æ˜¯ï¼Œä¸€ä¸å°å¿ƒæ”¹é”™äº†åœ°æ–¹ç„¶åå¯¼è‡´å½±å“äº†å…¶å®ƒåŠŸèƒ½ï¼Œå¼ºè€¦åˆçš„ä»£ç å¾ˆå®¹æ˜“å¼•å‘é“¾å¼ bug ååº” ğŸ™ˆã€‚å¯¹äºæ²¡æœ‰æ³¨é‡Šçš„ä»£ç ï¼Œæƒ³è¦è¯»æ‡‚é‡Œé¢çš„é€»è¾‘å¾€å¾€è¦åœ¨é‡Œé¢è¿›è¡Œ debuggerï¼Œæœ‰æ—¶è¿˜è¦å»çŒœã€‚æ›´è®©äººéš¾å—çš„æ˜¯ï¼Œæœ‰ä¸€äº›æ¨¡å—åŠŸèƒ½å¾ˆå¤šï¼Œæ‰€ä»¥ä»£ç é‡å¤§ï¼Œä¸€ä¸ª js æœ€å¤šè¾¾åˆ° 3000+ç”šè‡³ 4000+è¡Œï¼Œä¹Ÿæ²¡æœ‰å¯¹æ¨¡å—è¿›è¡Œä¸šåŠ¡å’ŒåŠŸèƒ½å‡½æ•°çš„æ‹†åˆ†ã€‚å…¶å®è¿™äº›çš„æ ¹æœ¬åŸå› å°±æ˜¯å‰æœŸå¼€å‘ï¼Œæ²¡æœ‰çº¦å®šå¥½ä»£ç è§„èŒƒç”¨å·¥å…·æ¥è¿›è¡Œå¼ºåˆ¶çº¦æŸï¼Œå¯¼è‡´åé¢è¶Šæ¥è¶Šå¤šå‘ï¼Œä¹Ÿå°±è¶Šæ¥è¶Šéš¾ç»´æŠ¤ã€‚</p>
<p>æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯å‰æœŸå°±å¿…é¡»è¦å¼•å…¥<code>Eslint</code>æ¥åˆ¶è®¢ä»£ç è§„èŒƒï¼Œä½¿ç”¨<code>prettier</code>æ¥ç»Ÿä¸€ä»£ç é£æ ¼ã€‚è™½ç„¶æ²¡é€‚åº”<code>Eslint</code>çš„ç«¥é‹ä¼šæ„Ÿåˆ°å¾ˆéš¾å—ï¼Œå› ä¸ºä¼šå‡ºç°å¾ˆå¤šç¼–è¯‘ä¸é€šè¿‡çš„é—®é¢˜ï¼Œæˆ‘å¼€å§‹ä¹Ÿä¸€æ ·ï¼Œä½†è¿™äº›éƒ½æ˜¯å°é—®é¢˜ï¼Œåªéœ€è¦æŒ‰é€ <code>Eslint</code>åˆ¶å®šå¥½çš„è§„èŒƒè¿›è¡Œå¯¹åº”çš„ä»£ç ä¿®æ”¹ï¼Œé•¿æœŸä¸‹æ¥ï¼Œä½ ä¼šå‘ç°<code>Eslint</code>ä¸ä»…èƒ½å¸®ä½ é¿å…ç¼–å†™ä½çº§é”™è¯¯çš„ä»£ç ï¼Œè¿˜èƒ½æå‡å›¢é˜Ÿçš„ä»£ç è´¨é‡ï¼Œæ›´å®¹æ˜“é˜…è¯»ã€‚</p>
<p><code>prettier</code>æ˜¯ä¸€ä¸ªä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œæˆ‘å¾ˆæ—©å°±å·²ç»å¼€å§‹ä½¿ç”¨äº†ã€‚è¿™æ˜¯ä¸€æ¬¾éå¸¸éå¸¸ç»™åŠ›çš„å·¥å…·ï¼Œå®ƒè¿ç”¨è‡ªèº«çš„è§„åˆ™å°†ä½ çš„çš„ä»£ç é‡æ–°æ ¼å¼åŒ–ï¼Œä¸ç®¡ä½ ä¹‹å‰çš„ä»£ç é£æ ¼æ˜¯æ€æ ·çš„ï¼Œæ€»ä¹‹ä½ å†™å®Œï¼Œå†ç”¨ä¸€ä¸‹è¿™ä¸ªå·¥å…·ï¼Œä»£ç â€œåˆ·â€ä¸€ä¸‹å°±å˜äº†ã€‚</p>
<p>åœ¨å›¢é˜Ÿåˆä½œçš„é¡¹ç›®ä¸­ï¼Œåœ¨åˆ¶å®šç›¸å…³è§„èŒƒæ—¶ï¼Œåº”é‡‡å–<strong>å°‘æ•°æœä»å¤šæ•°</strong>è§„åˆ™è¿›è¡Œåˆ¶å®šï¼Œæˆ‘è¿™å¥—æ¨¡æ¿ä¸»è¦æ˜¯ç”¨äº†<a href="https://github.com/airbnb/javascript" target="_blank" rel="external">airbnb</a>çš„ä»£ç è§„èŒƒã€‚</p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š</p>
<p><a href="https://eslint.org/" target="_blank" rel="external">Eslint</a></p>
<p><a href="https://prettier.io/" target="_blank" rel="external">Prettier</a></p>
<h2 id="Githook"><a href="#Githook" class="headerlink" title="Githook"></a>Githook</h2><p>æœ‰æ—¶å€™å¥½ä¸å®¹æ˜“å†™å®Œä¸šåŠ¡ä»£ç äº†ï¼Œå¥½ç´¯ï¼Œæµ‹è¯•ä¹Ÿ okï¼Œå¥½ï¼Œç›´æ¥æäº¤å§ï¼Œç„¶åæ²¡æœ‰æäº¤å®Œåå‘ç°<strong>å¿˜äº†ç”¨<code>prettier</code>è¿›è¡Œä»£ç æ ¼å¼åŒ–äº†ï¼ï¼</strong>æ‰€ä»¥ï¼Œ<code>Githook</code>å¯ä»¥ä¸ºæˆ‘ä»¬è§£å†³è¿™ç§æƒ…å†µçš„å‘ç”Ÿ(Githookï¼Œé¡¾åæ€ä¹‰ï¼Œä¹Ÿæ˜¯å°± git çš„é’©å­ï¼Œåœ¨å¯¹åº”çš„åŠŸèƒ½ä¸­ä¼šåˆ†åˆ«è§¦å‘)ã€‚æˆ‘è¿™è¾¹ç”¨<code>husky</code>å’Œ<code>lint-staged</code>å®ç°<code>pre-commit</code>é’©å­ç®¡ç†ã€‚ä¹Ÿå°±æ˜¯åœ¨<code>commit</code>ä»£ç å‰ï¼Œå¼ºåˆ¶ä½¿ç”¨<code>Eslint</code>å’Œ<code>prettier</code>è¿›è¡Œä»£ç è§„èŒƒçº¦æŸå’Œæ ¼å¼åŒ–ã€‚</p>
<p>å®‰è£…å¥½æ¨¡å—ï¼Œåœ¨<code>package.json</code>ä¸­ï¼Œåªéœ€è¦æ·»åŠ ä¸‹é¢çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"lint-staged"</span>: &#123;</div><div class="line">    <span class="string">"src/**/*.&#123;vue,js&#125;"</span>: [</div><div class="line">      <span class="string">"prettier --write"</span>,</div><div class="line">      <span class="string">"eslint --fix --ext"</span>,</div><div class="line">      <span class="string">"git add"</span></div><div class="line">    ],</div><div class="line">    <span class="string">"src/**/*.&#123;json,md,css,scss&#125;"</span>: [</div><div class="line">      <span class="string">"prettier --write"</span>,</div><div class="line">      <span class="string">"git add"</span></div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"husky"</span>: &#123;</div><div class="line">    <span class="string">"hooks"</span>: &#123;</div><div class="line">      <span class="string">"pre-commit"</span>: <span class="string">"lint-staged"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæäº¤åœ¨ src ç›®å½•ä¸‹çš„<code>.vue,.js</code>æ–‡ä»¶å…ˆè¿›è¡Œ<code>prettier</code>è¿›è¡Œä»£ç æ ¼å¼åŒ–ï¼Œå†è¿›è¡Œ<code>eslint</code>çš„è‡ªåŠ¨ä¿®å¤ï¼Œæœ€å add &amp;&amp; commitï¼Œå¦‚å›¾ï¼š</p>
<p><img src="/images/20180923/1.png" alt="pre-commit"></p>
<h2 id="Arcgis-æ¡†æ¶-api-è¯­æ³•æç¤º"><a href="#Arcgis-æ¡†æ¶-api-è¯­æ³•æç¤º" class="headerlink" title="Arcgis æ¡†æ¶ api è¯­æ³•æç¤º"></a>Arcgis æ¡†æ¶ api è¯­æ³•æç¤º</h2><p>æƒ³<code>Vue</code>ã€<code>React</code>è¿™äº›çƒ­é—¨çš„æ¡†æ¶ï¼Œæ˜¯æ‹¥æœ‰éå¸¸å¤šçš„ vscode è¯­æ³•æç¤ºæ’ä»¶çš„ï¼Œè€Œ<code>Dojo</code>å’Œ<code>Arcgis</code>éƒ½æ˜¯åå†·é—¨çš„æ¡†æ¶ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„ api æç¤ºæ’ä»¶ã€‚åæ¥æˆ‘ google äº†ä¸‹å‘ç°ï¼Œå¯ä»¥é€šè¿‡å®‰è£…<code>@types/arcgis-js-api</code>ï¼Œ<code>@types/dojo</code>è¿™ 2 ä¸ªæ¨¡å—ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª<code>tsd.d.ts</code>æ‹“å±•æ¥å‘Šè¯‰ vscodeï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// &lt;reference path="./node_modules/@types/arcgis-js-api/index.d.ts" /&gt;</span></div><div class="line"><span class="comment">/// &lt;reference path="./node_modules/@types/dojo/index.d.ts" /&gt;js</span></div></pre></td></tr></table></figure>
<p>æ•ˆæœï¼š</p>
<p><img src="/images/20180923/2.png" alt="æ¨¡å—å¼•å…¥æç¤º"></p>
<p>api æç¤ºï¼š</p>
<p><img src="/images/20180923/3.png" alt="apiè¾“å…¥æç¤º"></p>
<h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>å…¶å®è¿™ç®—æ˜¯å¯¹ä¸‰ä¸ªæœˆå‰æŠ€æœ¯åˆ†äº«çš„ä¸€äº›è¡¥å……ï¼Œä¿®æ”¹ä¸€äº› bug çš„åŒæ—¶ä¹ŸåŠ å…¥äº†æ¯”è¾ƒå¤šçš„åŠŸèƒ½ã€‚Vuecli æ˜¯æ­å»ºå‰ç«¯å¼€å‘ç¯å¢ƒçš„æœ€ä½³å®è·µï¼Œæ‰€ä»¥ç»§ç»­æ²¿ç”¨è¿™å¥—å®è·µæ–¹æ¡ˆä¹Ÿæ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚æœ€è¿‘<strong>Vuecli3</strong>ä¹Ÿå‘å¸ƒ release ç‰ˆäº†ï¼Œwebpack çš„é…ç½®æ²¡æœ‰åƒ Vuecli2 é‚£æ ·å…¨éƒ¨æš´éœ²å‡ºæ¥ï¼Œè€Œæ˜¯å°è£…æˆæ’ä»¶çš„å½¢å¼è¿›è¡ŒåŠ è½½ï¼Œå¯¹ä¸éœ€è¦æ€ä¹ˆæ›´æ”¹ webpack é…ç½®çš„å¼€å‘è€…æ¥è¯´æ˜¯éå¸¸å‹å¥½çš„ï¼Œä½†æ˜¯å¯¹äºåƒæˆ‘ä»¬è¿™ç§éœ€è¦æ”¹æ¯”è¾ƒå¤š webpack é…ç½®çš„é¡¹ç›®æ¥è¯´ï¼Œæ˜¯éœ€è¦ä¸€äº›å­¦ä¹ æˆæœ¬çš„ï¼Œå¦‚æœæƒ³æ›´æ”¹ webpack çš„é…ç½®ï¼Œåªèƒ½é€šè¿‡<code>webpack.chain</code>æ’ä»¶å»ä¿®æ”¹äº†ã€‚ç›®å‰è¿˜æ²¡ä»”ç»†å­¦ä¹ è¿™ä¸ªæ’ä»¶ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç‚¹æ—¶é—´ï¼Œä»¥åæå‡ºæ¥äº†å†åˆ†äº«å§(à¹‘â€¢Ì€ ã…‚â€¢Ì)Ùˆâœ§ï¼ŒVuecli3 éå¸¸å¼ºå¤§ï¼Œæˆ‘è§‰å¾—åªè¦ä¹ æƒ¯äº† Vuecli3ï¼Œå°±å›ä¸å» Vuecli2 äº†ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å‰ç«¯å°±æ˜¯è¦ç´§è·Ÿæ½®æµå§ï¼Œå“ˆå“ˆ ğŸ˜€</p>
<p>å›½é™…æƒ¯ä¾‹ï¼Œé™„ä¸Š<a href="https://github.com/shooterRao/arcgis-webpack-vue/tree/vuecli2" target="_blank" rel="external">github åœ°å€</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Rao Jinwei</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://shooterblog.site/2018/09/23/Vuecli2å¼•å…¥arcgis-js-apiæ–¹æ¡ˆæ€»ç»“(éesri-loaderæ–¹æ¡ˆ)/">http://shooterblog.site/2018/09/23/Vuecli2å¼•å…¥arcgis-js-apiæ–¹æ¡ˆæ€»ç»“(éesri-loaderæ–¹æ¡ˆ)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://shooterblog.site" target="_blank">Rao Jinwei's Blog</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/webpack/">webpack</a><a class="post-meta__tags" href="/tags/vue/">vue</a><a class="post-meta__tags" href="/tags/arcgis/">arcgis</a></div><elif theme.sharejs && theme.sharejs.enable></elif></article><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/11/04/Vueå®è·µå°ç»“(é•¿æœŸæ›´æ–°)/"><i class="fa fa-chevron-left">  </i><span>Vue å®è·µå°ç»“(é•¿æœŸæ›´æ–°)</span></a></div><div class="next-post pull-right"><a href="/2018/07/01/çœŸå®æ¡ˆä¾‹å¼•å‘å¯¹&quot;jså†…å­˜æ³„æ¼&quot;çš„ä¸€äº›æ€è€ƒ/"><span>çœŸå®æ¡ˆä¾‹å¼•å‘å¯¹&quot;jså†…å­˜æ³„æ¼&quot;çš„ä¸€äº›æ€è€ƒ</span><i class="fa fa-chevron-right"></i></a></div></nav><elif theme.laibili && theme.laibili.enable></elif><elif theme.gitment && theme.gitment.enable></elif><elif theme.gitalk && theme.gitalk.enable></elif></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2018 By Rao Jinwei</div><div class="framework-info"><span>é©±åŠ¨ - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.4.2"></script><script src="/js/fancybox.js?version=1.4.2"></script><script src="/js/sidebar.js?version=1.4.2"></script><script src="/js/copy.js?version=1.4.2"></script><script src="/js/fireworks.js?version=1.4.2"></script><script src="/js/transition.js?version=1.4.2"></script><script src="/js/scroll.js?version=1.4.2"></script><script src="/js/head.js?version=1.4.2"></script></body></html>