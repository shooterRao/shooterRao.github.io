<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Vue 实践小结(长期更新)"><meta name="keywords" content="vue"><meta name="author" content="Rao Jinwei,undefined"><meta name="copyright" content="Rao Jinwei"><title>Vue 实践小结(长期更新) | Rao Jinwei's Blog</title><link rel="shortcut icon" href="/sl.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.4.2"><script>var GLOBAL = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue"><span class="toc-number">2.</span> <span class="toc-text">Vue</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#子组件改变-props-的方法"><span class="toc-number">2.1.</span> <span class="toc-text">子组件改变 props 的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何在-vue-组件中绑定原生点击事件？"><span class="toc-number">2.2.</span> <span class="toc-text">如何在 vue 组件中绑定原生点击事件？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用组件时如何加行内-syle"><span class="toc-number">2.3.</span> <span class="toc-text">使用组件时如何加行内 syle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关于-v-model"><span class="toc-number">2.4.</span> <span class="toc-text">关于 v-model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#render-函数里如何用组件的-v-model"><span class="toc-number">2.5.</span> <span class="toc-text">render 函数里如何用组件的 v-model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Transition-组件-mode"><span class="toc-number">2.6.</span> <span class="toc-text">Transition 组件 mode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-属性不被代理的方法"><span class="toc-number">2.7.</span> <span class="toc-text">data 属性不被代理的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cli3-传递全局-scss-变量小坑"><span class="toc-number">2.8.</span> <span class="toc-text">cli3 传递全局 scss 变量小坑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#watch-路由中复用的组件的属性"><span class="toc-number">2.9.</span> <span class="toc-text">watch 路由中复用的组件的属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#父组件调用子组件方法"><span class="toc-number">2.10.</span> <span class="toc-text">父组件调用子组件方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关于数组和对象数据更新视图不更新问题"><span class="toc-number">2.11.</span> <span class="toc-text">关于数组和对象数据更新视图不更新问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iview-瞄点组件注意的问题"><span class="toc-number">2.12.</span> <span class="toc-text">iview 瞄点组件注意的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何利用-mount挂载实例-组件"><span class="toc-number">2.13.</span> <span class="toc-text">如何利用$mount挂载实例(组件)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue-router"><span class="toc-number">3.</span> <span class="toc-text">Vue-router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#beforeEach-路由守卫该注意的"><span class="toc-number">3.1.</span> <span class="toc-text">beforeEach 路由守卫该注意的</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://avatars1.githubusercontent.com/u/23609695?s=400&amp;u=d2db8f6efdee5add420addf7f89b916f7ef47ca7&amp;v=4"></div><div class="author-info__name text-center">Rao Jinwei</div><div class="author-info__description text-center">追寻生活的影子</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">13</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">15</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">10</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(http://pic1.win4000.com/wallpaper/7/59bb35a6c903f.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Rao Jinwei's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Vue 实践小结(长期更新)</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-04</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/vue/">vue</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>近期都在用 Vue 全家桶进行项目开发，过程中难免会遇到不少问题，这篇博客主要就是记录开发过程中遇到的问题，和每个问题对应的解决方案。此外，Vue 框架和周边生态会一直更新，以及发布新功能，在实践过程中总会遇到一些所谓的“坑”，我也会把填坑过程记录于此。坑是填不完的，这篇博客也是写不完的。🙂</p>
<a id="more"></a>
<h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><h3 id="子组件改变-props-的方法"><a href="#子组件改变-props-的方法" class="headerlink" title="子组件改变 props 的方法"></a>子组件改变 props 的方法</h3><p>由于 vue 遵循单向数据流，不建议在子组件里面直接改变 props 的值，一般通过 2 种方法</p>
<ul>
<li><p>通过<code>$emit</code>调用父组件事件来改变父组件传给子组件的值，然后在子组件里面<code>watch</code> props 的值，状态变化时触发相关反应</p>
</li>
<li><p>给 props 加个对象字段，如:</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">props: [<span class="string">'state'</span>],</div><div class="line"></div><div class="line">template: <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;state.someData.value&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">// 改</span></div><div class="line">js: <span class="keyword">this</span>.state.someData.value = xxx; <span class="comment">// 直接改变了父组件的data值</span></div></pre></td></tr></table></figure>
<h3 id="如何在-vue-组件中绑定原生点击事件？"><a href="#如何在-vue-组件中绑定原生点击事件？" class="headerlink" title="如何在 vue 组件中绑定原生点击事件？"></a>如何在 vue 组件中绑定原生点击事件？</h3><p>使用<code>.native</code>修饰符，这样原生点击事件会绑定到该组件的<code>$el</code>节点上</p>
<p>例如使用 iview 某个组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Card</span> @<span class="attr">click.native</span>=<span class="string">"handleClick"</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="使用组件时如何加行内-syle"><a href="#使用组件时如何加行内-syle" class="headerlink" title="使用组件时如何加行内 syle"></a>使用组件时如何加行内 syle</h3><p>在使用 vue 组件时，如果想给该组件加个行内 style，需要<code>:style=&quot;{}&quot;</code>这种写法，直接写 style 不会生效，class 则可以</p>
<h3 id="关于-v-model"><a href="#关于-v-model" class="headerlink" title="关于 v-model"></a>关于 v-model</h3><blockquote>
<p><code>v-model</code> 是 <code>v-bind:value</code> 和 <code>v-on:input</code> 和语法糖</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"value"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">:value</span>=<span class="string">"value"</span> <span class="attr">type</span>=<span class="string">"text"</span> @<span class="attr">input</span>=<span class="string">"value = $event.target.value"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">custom-input</span> <span class="attr">v-model</span>=<span class="string">"value"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>其中，custom-input 的写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Vue.component(<span class="string">"custom-input"</span>, &#123;</div><div class="line">  props: [<span class="string">"value"</span>],</div><div class="line">  template: <span class="string">`</span></div><div class="line"><span class="string">    &lt;input</span></div><div class="line"><span class="string">      :value="value"</span></div><div class="line"><span class="string">      @input="$emit('input', $event.target.value)"</span></div><div class="line"><span class="string">    &gt;</span></div><div class="line"><span class="string">  `</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="render-函数里如何用组件的-v-model"><a href="#render-函数里如何用组件的-v-model" class="headerlink" title="render 函数里如何用组件的 v-model"></a>render 函数里如何用组件的 v-model</h3><p>用 iview 中 Poptip 组件举例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">Poptip</span> <span class="attr">v-model</span>=<span class="string">"visible"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span>&gt;</span>Click<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span>Custom title<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">"content"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> @<span class="attr">click</span>=<span class="string">"close"</span>&gt;</span>close<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Poptip</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></div><div class="line"><span class="undefined">  data () &#123;</span></div><div class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></div><div class="line"><span class="javascript">      visible: <span class="literal">false</span></span></div><div class="line"><span class="undefined">    &#125;</span></div><div class="line"><span class="undefined">  &#125;,</span></div><div class="line"><span class="undefined">  methods: &#123;</span></div><div class="line"><span class="undefined">    close () &#123;</span></div><div class="line"><span class="javascript">      <span class="keyword">this</span>.visible = <span class="literal">false</span>;</span></div><div class="line"><span class="undefined">    &#125;</span></div><div class="line"><span class="undefined">  &#125;</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>用 render 函数方法调用该组件</p>
<p>核心就是把 v-model 拆成 value 和 input 的写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  name: <span class="string">"RenderPoptip"</span>,</div><div class="line">  data() &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      visible: <span class="literal">false</span></div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    close() &#123;</div><div class="line">      <span class="keyword">this</span>.visible = <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  render(h) &#123;</div><div class="line">    <span class="keyword">const</span> vm = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">    h(</div><div class="line">      <span class="string">"Poptip"</span>,</div><div class="line">      &#123;</div><div class="line">        props: &#123;</div><div class="line">          value: vm.visible</div><div class="line">        &#125;,</div><div class="line">        on: &#123;</div><div class="line">          input: <span class="function"><span class="params">e</span> =&gt;</span> &#123;</div><div class="line">            <span class="keyword">this</span>.visible = e;</div><div class="line">          &#125;</div><div class="line">        &#125;,</div><div class="line">        ref: <span class="string">"poptip"</span></div><div class="line">      &#125;,</div><div class="line">      [</div><div class="line">        h(<span class="string">"a"</span>, <span class="string">"click"</span>),</div><div class="line">        h(</div><div class="line">          <span class="string">"div"</span>,</div><div class="line">          &#123;</div><div class="line">            slot: <span class="string">"title"</span></div><div class="line">          &#125;,</div><div class="line">          <span class="string">"Custom title"</span></div><div class="line">        ),</div><div class="line">        h(<span class="string">"div"</span>, [</div><div class="line">          h(</div><div class="line">            <span class="string">"a"</span>,</div><div class="line">            &#123;</div><div class="line">              slot: <span class="string">"content"</span>,</div><div class="line">              on: &#123;</div><div class="line">                click: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">                  <span class="keyword">this</span>.close();</div><div class="line">                &#125;</div><div class="line">              &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="string">"关闭"</span></div><div class="line">          )</div><div class="line">        ])</div><div class="line">      ]</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>在 iview 的一些组件中，只提供 render 函数给我们渲染内部的内容，这时候我们可以用以上方法渲染 iview 的其它组件</p>
<p>template 模板写法和 render 写法最终都会渲染成<code>Vnode</code>，然后再挂载到 dom 上，在有些场景上，使用 render 写法更为清晰</p>
<h3 id="Transition-组件-mode"><a href="#Transition-组件-mode" class="headerlink" title="Transition 组件 mode"></a>Transition 组件 mode</h3><ul>
<li><p>in-out：新元素先进行过渡，完成之后当前元素过渡离开。</p>
</li>
<li><p>out-in：当前元素先进行过渡，完成之后新元素过渡进入。</p>
</li>
</ul>
<h3 id="data-属性不被代理的方法"><a href="#data-属性不被代理的方法" class="headerlink" title="data 属性不被代理的方法"></a>data 属性不被代理的方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  data: &#123;</div><div class="line">    _app: <span class="string">""</span>,</div><div class="line">    $ppa: <span class="string">""</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 以上_app,$ppa都不会被代理，只要加了_和$开头的属性都不会被vue代理</span></div><div class="line"><span class="comment">// this._app 和 this.$ppa皆不存在</span></div></pre></td></tr></table></figure>
<h3 id="cli3-传递全局-scss-变量小坑"><a href="#cli3-传递全局-scss-变量小坑" class="headerlink" title="cli3 传递全局 scss 变量小坑"></a>cli3 传递全局 scss 变量小坑</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// vue.config.js</span></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  css: &#123;</div><div class="line">    loaderOptions: &#123;</div><div class="line">      <span class="comment">// 给 sass-loader 传递选项</span></div><div class="line">      sass: &#123;</div><div class="line">        <span class="comment">// @/ 是 src/ 的别名</span></div><div class="line">        <span class="comment">// 所以这里假设你有 `src/variables.scss` 这个文件</span></div><div class="line">        data: <span class="string">`@import "@/variables.scss";`</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>注意</strong>：如果第一个加载的 vue 组件，<code>&lt;style&gt;</code>处没有声明<code>lang=scss</code>，然后第二个组件中声明了<code>scoped</code>也声明了<code>lang=scss</code>，那么上面传递的全局变量都会被前缀处理</p>
<p><strong>解决方案</strong>：第一个组件(通常 App.vue)style 处声明<code>lang=&#39;scss&#39;</code>且不能声明<code>scoped</code></p>
<h3 id="watch-路由中复用的组件的属性"><a href="#watch-路由中复用的组件的属性" class="headerlink" title="watch 路由中复用的组件的属性"></a>watch 路由中复用的组件的属性</h3><p>在使用<code>vue-router</code>中，在/page/a 跳转到 /page/b 中，如果注册的是动态路由，那么它们使用的也是同一个组件，例如 Page.vue。从 a 页面跳转到 b 页面，由于是同一个组件，vue-router 会复用这个在内存中的组件实例，所以相关生命周期不会重复调用，数据也不会更新，所以如果要在跳转页面做一些动作(例如：高亮菜单，数据获取)，就需要用<code>watch</code>方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">data() &#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    subNavList: []</div><div class="line">  &#125;</div><div class="line">&#125;,</div><div class="line">watch: &#123;</div><div class="line">  <span class="string">'$route'</span>: &#123;</div><div class="line">    handler: <span class="string">'getSubNavList'</span>,</div><div class="line">    immediate: <span class="literal">true</span> <span class="comment">// 使用这个就不需要在created里面调用getSubNavList</span></div><div class="line">  &#125;</div><div class="line">&#125;,</div><div class="line">methods: &#123;</div><div class="line">  getSubNavList(route) &#123;</div><div class="line">    <span class="keyword">this</span>.subNavList = getSubNavList(route)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="父组件调用子组件方法"><a href="#父组件调用子组件方法" class="headerlink" title="父组件调用子组件方法"></a>父组件调用子组件方法</h3><p>在父组件中用<code>$refs</code>或者<code>$children</code>拿到对应子组件实例对象进行调用</p>
<h3 id="关于数组和对象数据更新视图不更新问题"><a href="#关于数组和对象数据更新视图不更新问题" class="headerlink" title="关于数组和对象数据更新视图不更新问题"></a>关于数组和对象数据更新视图不更新问题</h3><p>这些都是 js 的限制，使用<code>Vue.set</code>方法解决，或者一些变异方法</p>
<p><a href="https://cn.vuejs.org/v2/guide/list.html#%E6%95%B0%E7%BB%84%E6%9B%B4%E6%96%B0%E6%A3%80%E6%B5%8B" target="_blank" rel="external">数组更新方法</a></p>
<p><a href="https://cn.vuejs.org/v2/guide/list.html#%E5%AF%B9%E8%B1%A1%E6%9B%B4%E6%94%B9%E6%A3%80%E6%B5%8B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" target="_blank" rel="external">对象更新方法</a></p>
<h3 id="iview-瞄点组件注意的问题"><a href="#iview-瞄点组件注意的问题" class="headerlink" title="iview 瞄点组件注意的问题"></a>iview 瞄点组件注意的问题</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"anchor-class "</span> <span class="attr">v-if</span>=<span class="string">"isAnchor"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">Anchor</span> <span class="attr">container</span>=<span class="string">".scrollcontent"</span> <span class="attr">show-ink</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">AnchorLink</span> <span class="attr">:href</span>=<span class="string">'"?name="+activeName+"#"+index'</span> <span class="attr">:title</span>=<span class="string">"itemData.name "</span> <span class="attr">v-for</span>=<span class="string">"(itemData,index) in selectCardList "</span> <span class="attr">:key</span>=<span class="string">"index "</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">Anchor</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>如果瞄点依赖的 dom 内容是要 ajax 获取信息进行渲染的，那么直接挂载瞄点组件会报错，因为组件渲染是比 ajax 快的，数据没回来，dom 节点没加载，瞄点组件无法扫描需要的 dom 节点，所以会出问题</p>
<p>用<code>v-if</code>+<code>nextTick</code>即可解决</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">created() &#123;</div><div class="line">  <span class="keyword">this</span>.$http.get(<span class="string">"xxx"</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (res.status === <span class="number">200</span>) &#123;</div><div class="line">      <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="comment">// nextTick回调函数中，scrollcontent内容已经渲染完毕</span></div><div class="line">        <span class="comment">// 这时可以渲染iview瞄点组件了</span></div><div class="line">        <span class="keyword">this</span>.isAnchor = <span class="literal">true</span>;</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="如何利用-mount挂载实例-组件"><a href="#如何利用-mount挂载实例-组件" class="headerlink" title="如何利用$mount挂载实例(组件)"></a>如何利用<code>$mount</code>挂载实例(组件)</h3><p>什么是<code>$mount</code>?</p>
<blockquote>
<p>如果 Vue 实例在实例化时没有收到 el 选项，则它处于“未挂载”状态，没有关联的 DOM 元素。可以使用 vm.$mount() 手动地挂载一个未挂载的实例</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"component-1"</span>&gt;</span></div><div class="line">  &#123;&#123;message&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"component-2"</span>&gt;</span></div><div class="line">  &#123;&#123;message&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"component-3"</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- &#123;&#123;message&#125;&#125; --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>挂载根实例</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 方法一</span></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  data: &#123;</div><div class="line">    message: <span class="string">"hello vue"</span></div><div class="line">  &#125;</div><div class="line">&#125;).$mount(<span class="string">"#app"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 方法二</span></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  el: <span class="string">"#app"</span>,</div><div class="line">  data: &#123;</div><div class="line">    message: <span class="string">"hello vue"</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>组件实例挂载</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 利用extend构造一个组件实例</span></div><div class="line"><span class="keyword">const</span> MyComponent = Vue.extend(&#123;</div><div class="line">  <span class="comment">// 注意，组件经常会被多次实例</span></div><div class="line">  <span class="comment">// 所以data必须是个函数</span></div><div class="line">  data() &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      message: <span class="string">"component"</span></div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 有三种方法可以挂载</span></div><div class="line"><span class="comment">// 方法一</span></div><div class="line"><span class="keyword">new</span> MyComponent().$mount(<span class="string">"#component-1"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 方法二</span></div><div class="line"><span class="keyword">new</span> MyComponent(&#123;</div><div class="line">  el: <span class="string">"#component-2"</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 方法三</span></div><div class="line"><span class="keyword">const</span> c = <span class="keyword">new</span> MyComponent(&#123;</div><div class="line">  data() &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      message: <span class="string">"component"</span></div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params">h</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> h(<span class="string">"span"</span>, <span class="keyword">this</span>.message);</div><div class="line">  &#125;</div><div class="line">&#125;).$mount();</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">"component-3"</span>).appendChild(c.$el);</div></pre></td></tr></table></figure>
<h2 id="Vue-router"><a href="#Vue-router" class="headerlink" title="Vue-router"></a>Vue-router</h2><h3 id="beforeEach-路由守卫该注意的"><a href="#beforeEach-路由守卫该注意的" class="headerlink" title="beforeEach 路由守卫该注意的"></a>beforeEach 路由守卫该注意的</h3><p>以简单的登录拦截举例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 开启路由守卫</span></div><div class="line"><span class="comment"> */</span></div><div class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// cookie上存了token，可以不用登录</span></div><div class="line">  <span class="keyword">const</span> token = getToken();</div><div class="line">  <span class="keyword">if</span> (token) &#123;</div><div class="line">    <span class="comment">// 如果要跳转的页面是登录页，强制跳转到根页面</span></div><div class="line">    <span class="keyword">if</span> (to.path === LOGIN_PAGE_PATH) &#123;</div><div class="line">      next(&#123; <span class="attr">path</span>: <span class="string">"/"</span> &#125;);</div><div class="line">    &#125;</div><div class="line">    next();</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// 没存就跳转到登录页面</span></div><div class="line">    <span class="keyword">if</span> (to.path !== LOGIN_PAGE_PATH) &#123;</div><div class="line">      next(&#123;</div><div class="line">        path: LOGIN_PAGE_PATH</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 这里如果不加next()，会进入死循环</span></div><div class="line">    <span class="comment">// 因为 next(&#123; path: LOGIN_PAGE_PATH &#125;)也会触发 beforeEach</span></div><div class="line">    <span class="comment">// 所以需要提供最终的next()，才能把导航的状态置为confirmed</span></div><div class="line">    next();</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Rao Jinwei</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://shooterblog.site/2018/11/04/Vue实践小结(长期更新)/">http://shooterblog.site/2018/11/04/Vue实践小结(长期更新)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明来自 <a href="http://shooterblog.site" target="_blank">Rao Jinwei's Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/vue/">vue</a></div><elif theme.sharejs && theme.sharejs.enable></elif></article><nav id="pagination"><div class="next-post pull-right"><a href="/2018/09/23/Vuecli2引入arcgis-js-api方案总结(非esri-loader方案)/"><span>Vuecli2引入Arcgis-js-api方案总结(非esri-loader方向)</span><i class="fa fa-chevron-right"></i></a></div></nav><elif theme.laibili && theme.laibili.enable></elif><elif theme.gitment && theme.gitment.enable></elif><elif theme.gitalk && theme.gitalk.enable></elif></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2018 By Rao Jinwei</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.4.2"></script><script src="/js/fancybox.js?version=1.4.2"></script><script src="/js/sidebar.js?version=1.4.2"></script><script src="/js/copy.js?version=1.4.2"></script><script src="/js/fireworks.js?version=1.4.2"></script><script src="/js/transition.js?version=1.4.2"></script><script src="/js/scroll.js?version=1.4.2"></script><script src="/js/head.js?version=1.4.2"></script></body></html>